var at=Object.defineProperty,it=Object.defineProperties;var ft=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var Pe=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var Re=(a,f,r)=>f in a?at(a,f,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[f]=r,H=(a,f)=>{for(var r in f||(f={}))Pe.call(f,r)&&Re(a,r,f[r]);if(M)for(var r of M(f))Oe.call(f,r)&&Re(a,r,f[r]);return a},J=(a,f)=>it(a,ft(f));var qe=(a,f)=>{var r={};for(var $ in a)Pe.call(a,$)&&f.indexOf($)<0&&(r[$]=a[$]);if(a!=null&&M)for(var $ of M(a))f.indexOf($)<0&&Oe.call(a,$)&&(r[$]=a[$]);return r};import{F as ot}from"./index.06de1df0.js";function ct(a,f){function r(){this.constructor=a}r.prototype=f.prototype,a.prototype=new r}function D(a,f,r,$){var l=Error.call(this,a);return Object.setPrototypeOf&&Object.setPrototypeOf(l,D.prototype),l.expected=f,l.found=r,l.location=$,l.name="SyntaxError",l}ct(D,Error);function K(a,f,r){return r=r||" ",a.length>f?a:(f-=a.length,r+=r.repeat(f),a+r.slice(0,f))}D.prototype.format=function(a){var f="Error: "+this.message;if(this.location){var r=null,$;for($=0;$<a.length;$++)if(a[$].source===this.location.source){r=a[$].text.split(/\r\n|\n|\r/g);break}var l=this.location.start,_=this.location.source+":"+l.line+":"+l.column;if(r){var A=this.location.end,w=K("",l.line.toString().length," "),E=r[l.line-1],d=l.line===A.line?A.column:E.length+1,h=d-l.column||1;f+=`
 --> `+_+`
`+w+` |
`+l.line+" | "+E+`
`+w+" | "+K("",l.column-1," ")+K("",h,"^")}else f+=`
 at `+_}return f};D.buildMessage=function(a,f){var r={literal:function(d){return'"'+l(d.text)+'"'},class:function(d){var h=d.parts.map(function(y){return Array.isArray(y)?_(y[0])+"-"+_(y[1]):_(y)});return"["+(d.inverted?"^":"")+h.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(d){return d.description}};function $(d){return d.charCodeAt(0).toString(16).toUpperCase()}function l(d){return d.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(h){return"\\x0"+$(h)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(h){return"\\x"+$(h)})}function _(d){return d.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(h){return"\\x0"+$(h)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(h){return"\\x"+$(h)})}function A(d){return r[d.type](d)}function w(d){var h=d.map(A),y,F;if(h.sort(),h.length>0){for(y=1,F=1;y<h.length;y++)h[y-1]!==h[y]&&(h[F]=h[y],F++);h.length=F}switch(h.length){case 1:return h[0];case 2:return h[0]+" or "+h[1];default:return h.slice(0,-1).join(", ")+", or "+h[h.length-1]}}function E(d){return d?'"'+l(d)+'"':"end of input"}return"Expected "+w(a)+" but "+E(f)+" found."};function Ie(a,f){f=f!==void 0?f:{};var r={},$=f.grammarSource,l={start:xe},_=xe,A=".",w="-",E="+",d="0",h=",",y='"',F="'",ze="#",Le="^",Me="_",Ze=":",W="[",Y="]",Be="<",Ge=">",Ue="@",Xe="!",He="(",Je=")",Ke="/",Qe="*",Ve="%",ee="struct",re="target",se="euclid",te="slow",ne="rotL",ae="rotR",ie="fast",fe="scale",oe="//",ce="cat",We="$",le="setcps",ue="setbpm",pe="hush",Ye=/^[1-9]/,er=/^[eE]/,rr=/^[0-9]/,ge=/^[ \n\r\t]/,sr=/^[0-9a-zA-Z~]/,ve=/^[^\n]/,tr=ye("number"),$e=g(".",!1),nr=j([["1","9"]],!1,!1),ar=j(["e","E"],!1,!1),he=g("-",!1),ir=g("+",!1),fr=g("0",!1),or=j([["0","9"]],!1,!1),cr=ye("whitespace"),me=j([" ",`
`,"\r","	"],!1,!1),lr=g(",",!1),ur=g('"',!1),pr=g("'",!1),gr=j([["0","9"],["a","z"],["A","Z"],"~"],!1,!1),vr=g("#",!1),$r=g("^",!1),hr=g("_",!1),mr=g(":",!1),_e=g("[",!1),de=g("]",!1),_r=g("<",!1),dr=g(">",!1),wr=g("@",!1),Ar=g("!",!1),br=g("(",!1),yr=g(")",!1),Cr=g("/",!1),xr=g("*",!1),Er=g("%",!1),Fr=g("struct",!1),jr=g("target",!1),Sr=g("euclid",!1),Rr=g("slow",!1),Pr=g("rotL",!1),Or=g("rotR",!1),qr=g("fast",!1),Dr=g("scale",!1),Ir=g("//",!1),we=j([`
`],!0,!1),Nr=g("cat",!1),kr=g("$",!1),Tr=g("setcps",!1),zr=g("setbpm",!1),Lr=g("hush",!1),Mr=function(){return parseFloat(ms())},Zr=function(e){return e.join("")},Br=function(e){return e},Gr=function(e){return e.arguments_.alignment="t",e},Ur=function(e){return{weight:e}},Xr=function(e){return{replicate:e}},Hr=function(e,t,n){return{operator:{type_:"bjorklund",arguments_:{pulse:e,step:t,rotation:n||0}}}},Jr=function(e){return{operator:{type_:"stretch",arguments_:{amount:e}}}},Kr=function(e){return{operator:{type_:"stretch",arguments_:{amount:"1/"+e}}}},Qr=function(e){return{operator:{type_:"fixed-step",arguments_:{amount:e}}}},Vr=function(e,t){return new nt(e,t)},Wr=function(e){return new U(e,"h")},Ae=function(e,t){return t},Yr=function(e,t){return t.length==0&&e instanceof Object?e:(t.unshift(e),new U(t,"v"))},es=function(e){return e},rs=function(e){return{name:"struct",args:{sequence:e}}},ss=function(e){return{name:"target",args:{name:e}}},ts=function(e,t,n){return{name:"bjorklund",args:{pulse:parseInt(e),step:parseInt(t)}}},ns=function(e){return{name:"stretch",args:{amount:e}}},as=function(e){return{name:"shift",args:{amount:"-"+e}}},is=function(e){return{name:"shift",args:{amount:e}}},fs=function(e){return{name:"stretch",args:{amount:"1/"+e}}},os=function(e){return{name:"scale",args:{scale:e.join("")}}},be=function(e,t){return t},cs=function(e,t){return t.unshift(e),new U(t,"t")},ls=function(e){return e},us=function(e,t){return new tt(e.name,e.args,t)},ps=function(e){return e},gs=function(e){return e},vs=function(e){return new X("setcps",{value:e})},$s=function(e){return new X("setcps",{value:e/120/2})},hs=function(){return new X("hush")},s=0,p=0,N=[{line:1,column:1}],x=0,Z=[],o=0,k;if("startRule"in f){if(!(f.startRule in l))throw new Error(`Can't start parsing from rule "`+f.startRule+'".');_=l[f.startRule]}function ms(){return a.substring(p,s)}function _s(){return B(p,s)}function g(e,t){return{type:"literal",text:e,ignoreCase:t}}function j(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function ds(){return{type:"end"}}function ye(e){return{type:"other",description:e}}function Ce(e){var t=N[e],n;if(t)return t;for(n=e-1;!N[n];)n--;for(t=N[n],t={line:t.line,column:t.column};n<e;)a.charCodeAt(n)===10?(t.line++,t.column=1):t.column++,n++;return N[e]=t,t}function B(e,t){var n=Ce(e),i=Ce(t);return{source:$,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:i.line,column:i.column}}}function c(e){s<x||(s>x&&(x=s,Z=[]),Z.push(e))}function ws(e,t,n){return new D(D.buildMessage(e,t),e,t,n)}function xe(){var e;return e=st(),e}function b(){var e,t;return o++,e=s,Ee(),t=T(),t!==r?(xs(),Cs(),p=e,e=Mr()):(s=e,e=r),o--,e===r&&o===0&&c(tr),e}function As(){var e;return a.charCodeAt(s)===46?(e=A,s++):(e=r,o===0&&c($e)),e}function bs(){var e;return Ye.test(a.charAt(s))?(e=a.charAt(s),s++):(e=r,o===0&&c(nr)),e}function ys(){var e;return er.test(a.charAt(s))?(e=a.charAt(s),s++):(e=r,o===0&&c(ar)),e}function Cs(){var e,t,n,i,v;if(e=s,t=ys(),t!==r){if(n=Ee(),n===r&&(n=Es()),n===r&&(n=null),i=[],v=S(),v!==r)for(;v!==r;)i.push(v),v=S();else i=r;i!==r?(t=[t,n,i],e=t):(s=e,e=r)}else s=e,e=r;return e}function xs(){var e,t,n,i;if(e=s,t=As(),t!==r){if(n=[],i=S(),i!==r)for(;i!==r;)n.push(i),i=S();else n=r;n!==r?(t=[t,n],e=t):(s=e,e=r)}else s=e,e=r;return e}function T(){var e,t,n,i;if(e=Fs(),e===r)if(e=s,t=bs(),t!==r){for(n=[],i=S();i!==r;)n.push(i),i=S();t=[t,n],e=t}else s=e,e=r;return e}function Ee(){var e;return a.charCodeAt(s)===45?(e=w,s++):(e=r,o===0&&c(he)),e}function Es(){var e;return a.charCodeAt(s)===43?(e=E,s++):(e=r,o===0&&c(ir)),e}function Fs(){var e;return a.charCodeAt(s)===48?(e=d,s++):(e=r,o===0&&c(fr)),e}function S(){var e;return rr.test(a.charAt(s))?(e=a.charAt(s),s++):(e=r,o===0&&c(or)),e}function u(){var e,t;for(o++,e=[],ge.test(a.charAt(s))?(t=a.charAt(s),s++):(t=r,o===0&&c(me));t!==r;)e.push(t),ge.test(a.charAt(s))?(t=a.charAt(s),s++):(t=r,o===0&&c(me));return o--,t=r,o===0&&c(cr),e}function R(){var e,t,n,i;return e=s,t=u(),a.charCodeAt(s)===44?(n=h,s++):(n=r,o===0&&c(lr)),n!==r?(i=u(),t=[t,n,i],e=t):(s=e,e=r),e}function P(){var e;return a.charCodeAt(s)===34?(e=y,s++):(e=r,o===0&&c(ur)),e===r&&(a.charCodeAt(s)===39?(e=F,s++):(e=r,o===0&&c(pr))),e}function z(){var e;return sr.test(a.charAt(s))?(e=a.charAt(s),s++):(e=r,o===0&&c(gr)),e===r&&(a.charCodeAt(s)===45?(e=w,s++):(e=r,o===0&&c(he)),e===r&&(a.charCodeAt(s)===35?(e=ze,s++):(e=r,o===0&&c(vr)),e===r&&(a.charCodeAt(s)===46?(e=A,s++):(e=r,o===0&&c($e)),e===r&&(a.charCodeAt(s)===94?(e=Le,s++):(e=r,o===0&&c($r)),e===r&&(a.charCodeAt(s)===95?(e=Me,s++):(e=r,o===0&&c(hr)),e===r&&(a.charCodeAt(s)===58?(e=Ze,s++):(e=r,o===0&&c(mr)))))))),e}function Fe(){var e,t,n;if(e=s,u(),t=[],n=z(),n!==r)for(;n!==r;)t.push(n),n=z();else t=r;return t!==r?(n=u(),p=e,e=Zr(t)):(s=e,e=r),e}function js(){var e,t,n,i;return e=s,u(),a.charCodeAt(s)===91?(t=W,s++):(t=r,o===0&&c(_e)),t!==r?(u(),n=Se(),n!==r?(u(),a.charCodeAt(s)===93?(i=Y,s++):(i=r,o===0&&c(de)),i!==r?(u(),p=e,e=Br(n)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Ss(){var e,t,n,i;return e=s,u(),a.charCodeAt(s)===60?(t=Be,s++):(t=r,o===0&&c(_r)),t!==r?(u(),n=L(),n!==r?(u(),a.charCodeAt(s)===62?(i=Ge,s++):(i=r,o===0&&c(dr)),i!==r?(u(),p=e,e=Gr(n)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Rs(){var e;return e=Fe(),e===r&&(e=js(),e===r&&(e=Ss())),e}function Ps(){var e;return e=Os(),e===r&&(e=Ds(),e===r&&(e=Is(),e===r&&(e=Ns(),e===r&&(e=ks(),e===r&&(e=qs()))))),e}function Os(){var e,t,n;return e=s,a.charCodeAt(s)===64?(t=Ue,s++):(t=r,o===0&&c(wr)),t!==r?(n=b(),n!==r?(p=e,e=Ur(n)):(s=e,e=r)):(s=e,e=r),e}function qs(){var e,t,n;return e=s,a.charCodeAt(s)===33?(t=Xe,s++):(t=r,o===0&&c(Ar)),t!==r?(n=b(),n!==r?(p=e,e=Xr(n)):(s=e,e=r)):(s=e,e=r),e}function Ds(){var e,t,n,i,v,m,C;return e=s,a.charCodeAt(s)===40?(t=He,s++):(t=r,o===0&&c(br)),t!==r?(u(),n=b(),n!==r?(u(),i=R(),i!==r?(u(),v=b(),v!==r?(u(),R(),u(),m=b(),m===r&&(m=null),u(),a.charCodeAt(s)===41?(C=Je,s++):(C=r,o===0&&c(yr)),C!==r?(p=e,e=Hr(n,v,m)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Is(){var e,t,n;return e=s,a.charCodeAt(s)===47?(t=Ke,s++):(t=r,o===0&&c(Cr)),t!==r?(n=b(),n!==r?(p=e,e=Jr(n)):(s=e,e=r)):(s=e,e=r),e}function Ns(){var e,t,n;return e=s,a.charCodeAt(s)===42?(t=Qe,s++):(t=r,o===0&&c(xr)),t!==r?(n=b(),n!==r?(p=e,e=Kr(n)):(s=e,e=r)):(s=e,e=r),e}function ks(){var e,t,n;return e=s,a.charCodeAt(s)===37?(t=Ve,s++):(t=r,o===0&&c(Er)),t!==r?(n=b(),n!==r?(p=e,e=Qr(n)):(s=e,e=r)):(s=e,e=r),e}function je(){var e,t,n;return e=s,t=Rs(),t!==r?(n=Ps(),n===r&&(n=null),p=e,e=Vr(t,n)):(s=e,e=r),e}function L(){var e,t,n;if(e=s,t=[],n=je(),n!==r)for(;n!==r;)t.push(n),n=je();else t=r;return t!==r&&(p=e,t=Wr(t)),e=t,e}function Se(){var e,t,n,i,v,m;if(e=s,t=L(),t!==r){for(n=[],i=s,v=R(),v!==r?(m=L(),m!==r?(p=i,i=Ae(t,m)):(s=i,i=r)):(s=i,i=r);i!==r;)n.push(i),i=s,v=R(),v!==r?(m=L(),m!==r?(p=i,i=Ae(t,m)):(s=i,i=r)):(s=i,i=r);p=e,e=Yr(t,n)}else s=e,e=r;return e}function Ts(){var e,t,n,i;return e=s,u(),t=P(),t!==r?(n=Se(),n!==r?(i=P(),i!==r?(p=e,e=es(n)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function zs(){var e;return e=Hs(),e===r&&(e=Bs(),e===r&&(e=Xs(),e===r&&(e=Ms(),e===r&&(e=Zs(),e===r&&(e=Ls(),e===r&&(e=Us(),e===r&&(e=Gs()))))))),e}function Ls(){var e,t,n;return e=s,a.substr(s,6)===ee?(t=ee,s+=6):(t=r,o===0&&c(Fr)),t!==r?(u(),n=O(),n!==r?(p=e,e=rs(n)):(s=e,e=r)):(s=e,e=r),e}function Ms(){var e,t,n,i,v;return e=s,a.substr(s,6)===re?(t=re,s+=6):(t=r,o===0&&c(jr)),t!==r?(u(),n=P(),n!==r?(i=Fe(),i!==r?(v=P(),v!==r?(p=e,e=ss(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Zs(){var e,t,n,i;return e=s,a.substr(s,6)===se?(t=se,s+=6):(t=r,o===0&&c(Sr)),t!==r?(u(),n=T(),n!==r?(u(),i=T(),i!==r?(u(),T(),p=e,e=ts(n,i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Bs(){var e,t,n;return e=s,a.substr(s,4)===te?(t=te,s+=4):(t=r,o===0&&c(Rr)),t!==r?(u(),n=b(),n!==r?(p=e,e=ns(n)):(s=e,e=r)):(s=e,e=r),e}function Gs(){var e,t,n;return e=s,a.substr(s,4)===ne?(t=ne,s+=4):(t=r,o===0&&c(Pr)),t!==r?(u(),n=b(),n!==r?(p=e,e=as(n)):(s=e,e=r)):(s=e,e=r),e}function Us(){var e,t,n;return e=s,a.substr(s,4)===ae?(t=ae,s+=4):(t=r,o===0&&c(Or)),t!==r?(u(),n=b(),n!==r?(p=e,e=is(n)):(s=e,e=r)):(s=e,e=r),e}function Xs(){var e,t,n;return e=s,a.substr(s,4)===ie?(t=ie,s+=4):(t=r,o===0&&c(qr)),t!==r?(u(),n=b(),n!==r?(p=e,e=fs(n)):(s=e,e=r)):(s=e,e=r),e}function Hs(){var e,t,n,i,v;if(e=s,a.substr(s,5)===fe?(t=fe,s+=5):(t=r,o===0&&c(Dr)),t!==r)if(u(),n=P(),n!==r){if(i=[],v=z(),v!==r)for(;v!==r;)i.push(v),v=z();else i=r;i!==r?(v=P(),v!==r?(p=e,e=os(i)):(s=e,e=r)):(s=e,e=r)}else s=e,e=r;else s=e,e=r;return e}function G(){var e,t,n,i;if(e=s,a.substr(s,2)===oe?(t=oe,s+=2):(t=r,o===0&&c(Ir)),t!==r){for(n=[],ve.test(a.charAt(s))?(i=a.charAt(s),s++):(i=r,o===0&&c(we));i!==r;)n.push(i),ve.test(a.charAt(s))?(i=a.charAt(s),s++):(i=r,o===0&&c(we));t=[t,n],e=t}else s=e,e=r;return e}function Js(){var e,t,n,i,v,m,C,q;if(e=s,a.substr(s,3)===ce?(t=ce,s+=3):(t=r,o===0&&c(Nr)),t!==r)if(u(),a.charCodeAt(s)===91?(n=W,s++):(n=r,o===0&&c(_e)),n!==r)if(u(),i=O(),i!==r){for(v=[],m=s,C=R(),C!==r?(q=O(),q!==r?(p=m,m=be(i,q)):(s=m,m=r)):(s=m,m=r);m!==r;)v.push(m),m=s,C=R(),C!==r?(q=O(),q!==r?(p=m,m=be(i,q)):(s=m,m=r)):(s=m,m=r);m=u(),a.charCodeAt(s)===93?(C=Y,s++):(C=r,o===0&&c(de)),C!==r?(p=e,e=cs(i,v)):(s=e,e=r)}else s=e,e=r;else s=e,e=r;else s=e,e=r;return e}function Ks(){var e;return e=Js(),e===r&&(e=Ts()),e}function O(){var e,t,n,i,v;if(e=s,t=Ks(),t!==r){for(u(),n=[],i=G();i!==r;)n.push(i),i=G();p=e,e=ls(t)}else s=e,e=r;return e===r&&(e=s,t=zs(),t!==r?(u(),a.charCodeAt(s)===36?(n=We,s++):(n=r,o===0&&c(kr)),n!==r?(i=u(),v=O(),v!==r?(p=e,e=us(t,v)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)),e}function Qs(){var e,t;return e=s,t=O(),t!==r&&(p=e,t=ps(t)),e=t,e===r&&(e=G()),e}function Vs(){var e;return e=Qs(),e}function Ws(){var e,t;return e=s,u(),t=Ys(),t===r&&(t=et(),t===r&&(t=rt())),t!==r?(u(),p=e,e=gs(t)):(s=e,e=r),e}function Ys(){var e,t,n;return e=s,a.substr(s,6)===le?(t=le,s+=6):(t=r,o===0&&c(Tr)),t!==r?(u(),n=b(),n!==r?(p=e,e=vs(n)):(s=e,e=r)):(s=e,e=r),e}function et(){var e,t,n;return e=s,a.substr(s,6)===ue?(t=ue,s+=6):(t=r,o===0&&c(zr)),t!==r?(u(),n=b(),n!==r?(p=e,e=$s(n)):(s=e,e=r)):(s=e,e=r),e}function rt(){var e,t;return e=s,a.substr(s,4)===pe?(t=pe,s+=4):(t=r,o===0&&c(Lr)),t!==r&&(p=e,t=hs()),e=t,e}function st(){var e;return e=Vs(),e===r&&(e=Ws()),e}var U=function(e,t){this.type_="pattern",this.arguments_={alignment:t},this.source_=e},tt=function(e,t,n){this.type_=e,this.arguments_=t,this.source_=n},nt=function(e,t){this.type_="element",this.source_=e,this.options_=t,this.location_=_s()},X=function(e,t){this.type_="command",this.name_=e,this.options_=t};if(k=_(),k!==r&&s===a.length)return k;throw k!==r&&s<a.length&&c(ds()),ws(Z,x<a.length?a.charAt(x):null,x<a.length?B(x,x+1):B(x,x))}const{pure:lt,Pattern:Q,Fraction:Ne,stack:ut,slowcat:pt,sequence:ke,timeCat:gt,silence:De,reify:Te}=ot,vt=a=>(f,r)=>{const l=a.source_[r].options_,_=l==null?void 0:l.operator;if(_){switch(_.type_){case"stretch":const w=Ne(_.arguments_.amount).inverse();return Te(f).fast(w);case"bjorklund":return f.euclid(_.arguments_.pulse,_.arguments_.step,_.arguments_.rotation)}console.warn(`operator "${_.type_}" not implemented`)}if(l!=null&&l.weight)return f;const A=Object.keys(l||{}).filter(w=>w!=="operator");return A.length&&console.warn(`option${A.length>1?"s":""} ${A.map(w=>`"${w}"`).join(", ")} not implemented`),f};function $t(a){a.source_=a.source_.map(f=>{const l=f.options_||{},{replicate:r}=l,$=qe(l,["replicate"]);return r?J(H({},f),{options_:J(H({},$),{weight:r}),source_:{type_:"pattern",arguments_:{alignment:"h"},source_:[{type_:"element",source_:f.source_,location_:f.location_,options_:{operator:{type_:"stretch",arguments_:{amount:Ne(r).inverse().toString()}}}}]}}):f})}function I(a){switch(a.type_){case"pattern":$t(a);const f=a.source_.map(I).map(vt(a)),r=a.arguments_.alignment;if(r==="v")return ut(...f);const $=a.source_.some(l=>{var _;return!!((_=l.options_)!=null&&_.weight)});if(!$&&r==="t")return pt(...f);if($){const l=gt(...a.source_.map((_,A)=>{var w;return[((w=_.options_)==null?void 0:w.weight)||1,f[A]]}));if(r==="t"){const _=a.source_.reduce((A,w)=>{var E;return A+(((E=w.options_)==null?void 0:E.weight)||1)},0);return l._slow(_)}return l}return ke(...f);case"element":if(a.source_==="~")return De;if(typeof a.source_!="object"){if(!a.location_)return console.warn("no location for",a),a.source_;const{start:l,end:_}=a.location_,A=isNaN(Number(a.source_))?a.source_:Number(a.source_);return lt(A).withLocation([l.line,l.column,l.offset],[_.line,_.column,_.offset])}return I(a.source_);case"stretch":return I(a.source_).slow(a.arguments_.amount);default:return console.warn(`node type "${a.type_}" not implemented -> returning silence`),De}}const V=(...a)=>{const f=a.map(r=>{const $=Ie(`"${r}"`);return I($)});return ke(...f)},ht=a=>{const f=Ie(a);return I(f)};Q.prototype.define("mini",V,{composable:!0});Q.prototype.define("m",V,{composable:!0});Q.prototype.define("h",ht,{composable:!0});function dt(a){return typeof a=="string"?V(a):Te(a)}export{D as SyntaxError,ht as h,V as mini,dt as minify,Ie as parse,I as patternifyAST};
